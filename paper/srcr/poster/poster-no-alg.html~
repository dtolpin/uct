<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml">

  <head>
    <title>Rational Deployment of CSP Heuristics</title>
    <!-- metadata -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="generator" content="PSS" />
    <meta name="version" content="PSS 0.0" />
    <meta name="author" content="David Tolpin" />
    <meta name="company" content="Offtopia" />
    <!-- style links -->
    <link rel="stylesheet" href="style/poster.css" type="text/css" id="posterStyle"/>
    <link rel="stylesheet" href="style/view.css" type="text/css" media="projection" id="viewStyle" />
    <link rel="stylesheet" href="style/print.css" type="text/css" media="print" id="printStyle" />
    <link rel="stylesheet" href="style/read.css" type="text/css" media="screen" id="readStyle" />

    <!-- script links -->
    <script src="./mathjax/MathJax.js" type="text/javascript">
      MathJax.Hub.Config({
      extensions: ["tex2jax.js"],
      jax: ["input/TeX","output/HTML-CSS"],
      tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
      noImageFonts: true
      });
    </script>
    <script src="script/poster.js" type="text/javascript"></script>
  </head>
  <body>
    <div class="author">David Tolpin, Solomon Eyal Shimony<br/>Ben Gurion University of the Negev,<br/>Beer Sheva, Israel
    </div>
    <h1>Rational Deployment of CSP Heuristics<br/><span style="font-size: 80%; line-height: 0.5">IJCAI 2011</span></h1>

    <div class="tosafot">
      <div class="zoomable region">
        <h2><span>Constraint Satisfaction</span></h2>
        <p>A constraint satisfaction problem (CSP) is defined by:</p>
        <ul style="list-style-type: none; margin-left: 1em">
          <li><b>variables</b> $\mathcal{X}=\{X_1, X_2, ...\}$, </li>
          <li><b>constraints</b> $\mathcal{C}=\{C_1, C_2, ...\}$.</li> 
        </ul>
        <ul>
          <li>Each <i>variable</i> $X_i$ has a non-empty domain
          $D_i$ of possible values. </li>
          <li>Each <i>constraint</i> $C_i$ involves some subset
          of the variables&#x2014;the <i>scope</i> of the constraint&#x2014;and specifies the
          allowable combinations of values for that subset. </li>
          <li>An <i>assignment</i> that does not violate any constraints is called
          <i>consistent</i> (or solution).</li>
        </ul>
      </div>
      <div class="zoomable region">
        <h2><span>Rational Metareasoning</span></h2>
        <ul>
          <li>A problem-solving agent can perform <i>base-level</i> actions from a known
          set $\{A_i\}$.</li>
          <li>Before committing to an action, the agent may perform a sequence of
          <i>meta-level</i> deliberation actions from a set $\{S_j\}$.</li>
          <li>At any given time there is a base-level action $A_\alpha$ that maximizes
          the agent's <i>expected utility.</i></li>
        </ul>
        <p>

          The <b>net VOI $V(S_j)$</b> of action $S_j$ is the intrinsic VOI $\Lambda_j$ less the cost of $S_j$:
          \[V(S_j)=\Lambda(S_j)-C(S_j)\]
        </p>
        <p>The <b>intrinsic VOI $\Lambda(S_j)$</b>
          is the expected difference between the intrinsic expected utilities of the new
          and the old selected base-level action, <em>computed after the meta-level
          action is taken:</em>
          \[\Lambda(S_j)=\mathbb{E}\left(\mathbb{E}(U(A_\alpha^j))-\mathbb{E}(U(A_\alpha))\right)\]
        </p>
        <ul>
          <li> $S_{j_{\max}}$ that maximizes the net VOI  is performed: $j_{\max} = \arg\max_jV(S_j)$, 
              <br/><em>if $V(S_{j_{\max}})>0$.</em></li>
          <li>Otherwise, $A_\alpha$ is performed.
      </div>
      <div class="zoomable region" style="clear: right; margin-top: 3em">
        <h2><span>Acknowledgments</span></h2>
        <ul>
          <li>IMG4 Consortium under the MAGNET program of the Israeli Ministry of Trade and
          Industry</li>
          <li>Israel Science Foundation grant 305/09</li>
          <li>Lynne and William Frankel Center for Computer Sciences</li>
          <li>Paul Ivanier Center for Robotics Research and Production Management</li>
        </ul>

      </div>
    </div>

    
    <div class="rashi">
       <div class="zoomable region">
        <h2><span>Experiments</span></h2>
        <h3>Benchmarks</h3>
        <p>CSP benchmarks from CSP Solver Competition 2005
        were used. 14 benchmarks
        were solved for $\gamma=0$&nbsp; and the
        exponential range $\gamma \in \{10^{-7},$ $10^{-6},$ $...,$ $1\}$,&nbsp; as well
        as with the minimum-conflicts heuristic and the pAC heuristic.
        </p>
        <object data="benchmarks.svg" style="text-align: center; width: 99%"></object>
        <p>
          The maximum improvement is  
          achieved when <em>the solution count is estimated only in a small fraction of
          occasions</em> selected using rational metareasoning.
        </p>
        <h3 style="clear: right;  margin-top: 1.5em">Random instances</h3>
        <p>Based on the results on benchmarks, we chose $\gamma=10^{-3}$, and
        applied it to two sets of 100 problem instances. Exhaustive deployment,
        rational deployment, the minimum conflicts heuristic, and the pAC heuristic
        were compared.</p>

        <object data="random-problems-arrows+legend.svg" style="text-align: center; width: 99%"></object>
        
        <p><em>The value of $\gamma$ chosen based on a small set of hard instances
        gave good results on a set of instances with different parameters and
        of varying hardness.</em>
        </p>
        <h3 style="clear: right; margin-top: 1.5em">Generalized Sudoku</h3>
        <ul>
          <li>Real-world problem instances often have much more structure
          than random instances generated according to Model RB.</li>
          <li>We repeated the
          experiments on randomly generated Generalized Sudoku instances&#x2014;
          a highly structured domain.</li>
          <li><em>Relative performance on Generalized
          Sudoku was similar to  Model RB.</em></li>
        </ul>
      </div>

    </div>

    <div class="guf">
      <div class="zoomable region mishna">
        <h2><span>Overview</span></h2>
        <ul style="list-style-type: none; margin-left: -1em">
          <li>Heuristics are crucial tools in decreasing search effort in various areas of AI.</li>
          <li>A heuristic must provide useful information to the search algorithm,
              and be efficient to compute.
          </li>
          <li>Overhead of some well-known heuristics may outweigh the gain.</li>
          <li>Such heuristics should be deployed selectively, based on principles of <em>rational metareasoning.</em></li>
        </ul>
        <h3>Case Study</h3>
        <ul>
          <li>CSP backtracking search algorithms typically employ
          variable-ordering and value-ordering heuristics.</li>
          <li>Many value ordering heuristics are computationally
          heavy, e.g. heuristics <em>based on solution count
          estimates.</em></li>
          <li>Principles of rational metareasoning can be applied
          to decide when to deploy the heuristics.
        </p>
      </div>
      <div class="zoomable region gmara">
        <h2><span>Value Ordering</span></h2>
        <p>Value ordering heuristics provide information about:
        </p>
        <ul style="list-style: none">
          <li>$T_i$&#x2014;the expected time to find a solution containing
          an assignment  $X_k=y_{ki};$</li>
          <li>$p_i$&#x2014;the probability that there is no solution consistent with $X_k=y_{ki}$.</li>
        </ul>
        <p>        The expected remaining search time in the subtree under $X_k$ for ordering $\omega$ is given by:
        \[T^{s|\omega}=T_{\omega(1)}+\sum_{i=2}^{|D_k|}T_{\omega(i)}\prod_{j=1}^{i-1}p_{\omega(j)}\]
        </p>
        <ul>
          <li>The current optimal base-level action is picking the $\omega $ which optimizes $T^{s|\omega}$.  $T^{s|\omega}$ is minimal if the values are sorted  by increasing order of $\frac {T_i} {1-p_i}$.</li>
          <li>The intrinsic VOI $\Lambda_i$ of estimating $T_i, p_i$ for the $i$th assignment is the expected decrease in the expected search time:
          $\Lambda_i=\mathbb{E}\left[T^{s|\omega_-}-T^{s|\omega_{+i}}\right]$.</li>
          <li>Computing new estimates (with overhead $T^c$) for values $T_i, p_i$ is beneficial just when the net VOI is positive:  $V_i=\Lambda_i-T^c$.</li>
        </ul>
      </div>
      <div class="zoomable region halacha">
        <h2><span>Main Results</span></h2>
        <h3>Rational Value Ordering</h3>
        <p>The intrinsic VOI $\Lambda_i$ of invoking the heuristic can be approximated as:
        \[\Lambda_i\approx \mathbb{E}\left[(T_1-T_i)|D_k|\,\Big|\; T_i &lt; T_1 \right]\]
        </p>
        <h3>VOI of Solution Count Estimates</h3>
        The net VOI $V$ of estimating a solution count can be approximated as:
        \[V \propto |D_k|e^{-\nu}\sum_{n=n_\mathrm{max}}^\infty \! \! \left( \frac 1 {n_\mathrm{max}} - \frac 1 n\right) \frac {\nu^n} {n!}-\gamma\]
        where the constant $\gamma$ <strong>depends on the search algorithm and the heuristic, rather than on the CSP instance,</strong> and can be learned offline. 
        The infinite sum $\sum_{n=n_\mathrm{max}}^\infty \! \! \left( \frac 1 {n_\mathrm{max}} - \frac 1 n\right) \frac {\nu^n} {n!}$ is rapidly converging and can be computed efficiently.

      </div>
    </div>

    <div style="clear: both" />

    <div class="zoomable region musar">
      <h2><span>Conclusions</span></h2>
      <ul>
        <li>This work suggests a <em>model for adaptive deployment</em> of value ordering
        heuristics in algorithms for constraint satisfaction problems.</li>
        <li>As a case study, the model was applied to a value-ordering heuristic based
        on solution count estimates, and a <em>steady improvement</em>  was achieved
        compared to <strong>always</strong> computing the estimates. </li> 
        <li>For many problem instances the optimum
        performance is achieved when solution <em>counts are estimated only in a
        small number of search states.</em></li>
       </ul>

    </div>

    <div class="zoomable region safek">
      <h2><span>Future Work</span></h2>
      <div class="region barcode">
        <a href="http://www.offtopia.net/ijcai-2011-csp-poster/"><img width="100%" src="barcode.png" alt="http://www.offtopia.net/ijcai-2011-csp-poster/" /></a>
      </div>
      <ul>
        <li>Generalization of the VOI to deploy different types of
        heuristics for CSP.</li>
        <li>Explicit evaluation of the quality of the distribution model, coupled
        with a better candidate model of the distribution.</li>
        <li>Application to search in other domains, especially
        to heuristics for planning;  in particular, <em>examining whether
        the meta-reasoning scheme can improve reasoning over deployment based
        solely on learning.</em></li>
      </ul>
    </div>

    <br style="clear: both" />
    
  </body>
</html>
